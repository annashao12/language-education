---
title: "Language Education Data"
execute: 
  echo: false
---

```{r}
#| message: false
#| label: setup

library(tidycensus)
library(tidyverse)
```


```{r}
#| label: data
#| message: false


# Find and display correct variables from the S1603 table
variables <- load_variables(2022, "acs5", cache = TRUE) %>%
  filter(str_detect(name, "S1603"))

# Define the correct variables based on the output of load_variables
variables <- c(
  english_total = "S1603_C02_001E",   # Total population speaking only English
  spanish_total = "S1603_C06_001E",   # Total population speaking Spanish
  other_total = "S1603_C04_001E",     # Total population speaking other languages
  english_bachelors = "S1603_C02_016E", # Bachelor's degree or higher for English speakers
  spanish_bachelors = "S1603_C06_016E", # Bachelor's degree or higher for Spanish speakers
  other_bachelors = "S1603_C04_016E"    # Bachelor's degree or higher for other language speakers
)

# Fetch data for the entire US
data <- get_acs(
  geography = "us",
  variables = variables,
  year = 2022,
  survey = "acs5",
  output = "wide"
)

# Calculate percentage of population with bachelor's degree
data <- data %>%
  mutate(
    english_percentage_bachelors = (english_bachelors / english_total) * 100,
    spanish_percentage_bachelors = (spanish_bachelors / spanish_total) * 100,
    other_percentage_bachelors = (other_bachelors / other_total) * 100
  )

# Reshape data for plotting
data_long <- data %>%
  select(english_percentage_bachelors, spanish_percentage_bachelors, other_percentage_bachelors) %>%
  pivot_longer(cols = everything(), names_to = "language", values_to = "percentage_bachelors") %>%
  mutate(language = case_when(
    language == "english_percentage_bachelors" ~ "English",
    language == "spanish_percentage_bachelors" ~ "Spanish",
    language == "other_percentage_bachelors" ~ "Other"
  ))

# Create the bar graph using ggplot2

```

```{r}
#| label: plot

ggplot(data_long, aes(x = language, y = percentage_bachelors)) +
  geom_bar(stat = "identity", fill = "skyblue", width = 0.7) +
  labs(
    title = "Percentage of Population with Bachelor's Degree by Language Spoken at Home",
    subtitle = "In the US, most Non-English Speakers are almost as likely to get bachelors degrees as\nEnglish Speakers",
    x = "Language Spoken at Home",
    y = "Percentage with Bachelor's Degree"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Depending on what language you speak at home, education rates can vary. The following data was pulled from the US Census Bureau. The relevant variables were pulled to analyse the relationship between language spoken at home and education rate. While Spanish speakers seem to be at a disadvantage when it comes to education, speakers of other languages are doing almost as well as English speakers.

